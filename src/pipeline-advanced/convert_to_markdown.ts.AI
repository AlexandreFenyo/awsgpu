
Ce script TypeScript utilise les bibliothèques Python suivantes :
- Mammoth.js
- BeatifulSoup

Il prend en entrée un nom de fichier etl e transforme en deux étapes en fichier Markdown, voici comment :
- Il transforme le fichier d'entrée en un fichier au format HTML, à l'aide de Mammoth. Le nom de fichier de sortie HTML est composé du nom de fichier d'entrée auquel on ajoute le suffixe ".html". Il affiche le nom du fichier HTML produit.
- Puis il transforme ce fichier HTML en Markdown, à l'aide de BeatifulSoup. Le nom de fichier de sortie Markdown est composé du nom de fichier HTML auquel on ajoute le suffixe ".md". Il affiche le nom du fichier Markdown produit.

----------------------

/ask Est-ce qu'il est possible de conserver les numéros de titres, sous-titres, etc, dans les documents produits ?

réponse :
Oui, mais il y a deux cas à distinguer.

 1 Si les numéros font partie du texte (ex. “1. Introduction” tapé tel quel dans Word)

 • Rien à faire: Mammoth les conserve et ils seront présents dans le HTML puis dans le Markdown.

 2 Si les numéros sont des numérotations automatiques (Word/Outline)

 • Mammoth ne met pas ces numéros “en dur” dans le HTML pour les titres. Il faut donc:
    • Reconstituer la numérotation des titres lors de la passe HTML → Markdown.
    • Préserver la numérotation des listes ordonnées (ol/li) en respectant les attributs start/value.

Modifs brèves côté html_to_markdown.py:



 • Titres: dans html_to_markdown, garder un tableau de compteurs par niveau (h1..h6). À chaque hN:
    • counters[N-1] += 1; remettre à 0 les compteurs > N.
    • Préfixer le texte du titre avec "1.", "1.2", etc. Exemple d’algorithme:
       • prefix = ".".join(str(c) for c in counters[:N] if c) + " "
       • rendre f"{'#'*N} {prefix}{text}"
 • Listes ordonnées: faire respecter  et .
    • Passer start à _render_list (ex: start = int(ol.get("start", 1))).
    • Numéroter chaque li avec li.get("value") si présent, sinon incrément courant.
    • Émettre littéralement “n. texte” (Markdown accepte des numéros explicites par item).

Limites:

 • La reconstitution des numéros de titres reflète la structure (h1/h2/…) détectée, pas forcément toutes les subtilités de Word si la hiérarchie est irrégulière.
 • Pour les listes, Markdown ne garantit pas toujours le rendu d’un start != 1 selon le renderer, mais en écrivant “n. ” à chaque ligne on force la valeur affichée. Souhaites-tu que je te propose
   un patch minimal pour ces deux points ?

Ma demande :
Ce sont des numéros de titres automatiques de Word. Peux-tu le mettre en place et appliquer les patches que tu proposes ?

----------------------

Voici un  exemple de la façon dont apparaît actuellement une footnote, dans la sortie HTML :
<h3><a id="_Toc268246581"></a><a id="_Toc268164040"></a><a id="_Toc133584987"></a><a id="_Toc133585728"></a><a id="_Toc133594347"></a><a id="_Toc133595302"></a><a id="_Toc133916630"></a><a id="_Toc134090593"></a><a id="_Toc136444729"></a><a id="_Toc137041994"></a><a id="_Toc137042958"></a><a id="_Toc137213628"></a><a id="_Toc138420691"></a><a id="_Toc138428338"></a><a id="_Toc138428629"></a><a id="_Toc138662876"></a><a id="_Toc145663146"></a><a id="_Toc153377668"></a><a id="_Toc153456919"></a><a id="_Toc153458506"></a><a id="_Toc153466158"></a><a id="_Toc156997992"></a><a id="_Toc157007125"></a><a id="_Toc157008311"></a><a id="_Toc157092441"></a><a id="_Toc158302320"></a><a id="_Toc158383939"></a>Présentation géographique de l’organisation DDSI et des CTI-CEIR<sup><a href="#footnote-2" id="footnote-ref-2">[1]</a></sup>.</h3><p>La DDSI est implantée sur le siège à Paris et sur 16 sites dont le site de Quimper créé en 2020.</p><p>La carte ci-dessous présente les activités associées aux 16 sites.</p><ol><li id="footnote-2"><p> CTI : Centre de traitement informatique</p><p>CEIR : Centre éditique informatique régional <a href="#footnote-ref-2">↑</a></p></li></ol>

Je veux désormais que le texte des footnotes soit être inséré à l'endroit où la footnote est référencée dans le texte d'origine, afin de ne pas avoir à produire des footnotes en sortie, mais que l'information soit à l'endroit où elle est référencée dans le texte d'origine.

----------------------

src/pipeline-advanced/convert_to_markdown.ts src/pipeline-advanced/html_to_markdown.py

----------------------

Ne reprend pas la table des matières dans le html produit.

----------------------

/ask Est-ce normal que les listes numérotées, quand elles sont dans une case d'un tableau, sont supprimées ?
Applique ces modifications.
